(base) PS Q:\projects\Backdoor-Attack-Against-Split-Neural-Network-Based-Vertical-Federated-Learning> C:/Users/xuan/anaconda3/Scripts/activate
(base) PS Q:\projects\Backdoor-Attack-Against-Split-Neural-Network-Based-Vertical-Federated-Learning> conda activate ml
(ml) PS Q:\projects\Backdoor-Attack-Against-Split-Neural-Network-Based-Vertical-Federated-Learning> conda install pytorch torchvision torchaudio pytorch-cuda=12.1 -c pytorch -c nvidia
Channels:
 - pytorch
 - nvidia
 - defaults
Platform: win-64
Collecting package metadata (repodata.json): done
Solving environment: done

## Package Plan ##

  environment location: C:\Users\xuan\anaconda3\envs\ml

  added / updated specs:
    - pytorch
    - pytorch-cuda=12.1
    - torchaudio
    - torchvision


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    brotli-python-1.0.9        |   py38hd77b12b_8         347 KB
    certifi-2024.2.2           |   py38haa95532_0         160 KB
    charset-normalizer-2.0.4   |     pyhd3eb1b0_0          35 KB
    filelock-3.13.1            |   py38haa95532_0          21 KB
    gmpy2-2.1.2                |   py38h7f96b67_0         160 KB
    idna-3.7                   |   py38haa95532_0         115 KB
    intel-openmp-2021.4.0      |    haa95532_3556         2.2 MB
    jinja2-3.1.3               |   py38haa95532_0         271 KB
    lz4-c-1.9.4                |       h2bbff1b_1         152 KB
    markupsafe-2.1.3           |   py38h2bbff1b_0          25 KB
    mkl-2021.4.0               |     haa95532_640       114.9 MB
    mkl-service-2.4.0          |   py38h2bbff1b_0          51 KB
    mkl_fft-1.3.1              |   py38h277e83a_0         139 KB
    mkl_random-1.2.2           |   py38hf11a4ad_0         225 KB
    mpc-1.1.0                  |       h7edee0f_1         260 KB
    mpfr-4.0.2                 |       h62dcd97_1         1.5 MB
    mpir-3.0.0                 |       hec2e145_1         1.3 MB
    mpmath-1.3.0               |   py38haa95532_0         832 KB
    networkx-3.1               |   py38haa95532_0         2.7 MB
    numpy-1.24.3               |   py38hf95b240_0          11 KB
    numpy-base-1.24.3          |   py38h005ec55_0         6.1 MB
    pillow-10.3.0              |   py38h2bbff1b_0         837 KB
    pysocks-1.7.1              |   py38haa95532_0          31 KB
    pytorch-2.3.0              |py3.8_cuda12.1_cudnn8_0        1.20 GB  pytorch
    pyyaml-6.0.1               |   py38h2bbff1b_0         160 KB
    requests-2.31.0            |   py38haa95532_1          98 KB
    six-1.16.0                 |     pyhd3eb1b0_1          18 KB
    sympy-1.12                 |   py38haa95532_0        10.5 MB
    torchaudio-2.3.0           |       py38_cu121         7.0 MB  pytorch
    torchvision-0.18.0         |       py38_cu121         7.6 MB  pytorch
    typing_extensions-4.11.0   |   py38haa95532_0          61 KB
    urllib3-2.1.0              |   py38haa95532_1         154 KB
    win_inet_pton-1.1.0        |   py38haa95532_0          35 KB
    xz-5.4.6                   |       h8cc25b3_1         609 KB
    zlib-1.2.13                |       h8cc25b3_1         131 KB
    zstd-1.5.5                 |       hd43e919_2         720 KB
    ------------------------------------------------------------
                                           Total:        1.36 GB

The following NEW packages will be INSTALLED:

  blas               pkgs/main/win-64::blas-1.0-mkl
  brotli-python      pkgs/main/win-64::brotli-python-1.0.9-py38hd77b12b_8
  certifi            pkgs/main/win-64::certifi-2024.2.2-py38haa95532_0
  charset-normalizer pkgs/main/noarch::charset-normalizer-2.0.4-pyhd3eb1b0_0
  cuda-cccl          nvidia/win-64::cuda-cccl-12.4.127-0
  cuda-cudart        nvidia/win-64::cuda-cudart-12.1.105-0
  cuda-cudart-dev    nvidia/win-64::cuda-cudart-dev-12.1.105-0
  cuda-cupti         nvidia/win-64::cuda-cupti-12.1.105-0
  cuda-libraries     nvidia/win-64::cuda-libraries-12.1.0-0
  cuda-libraries-dev nvidia/win-64::cuda-libraries-dev-12.1.0-0
  cuda-nvrtc         nvidia/win-64::cuda-nvrtc-12.1.105-0
  cuda-nvrtc-dev     nvidia/win-64::cuda-nvrtc-dev-12.1.105-0
  cuda-nvtx          nvidia/win-64::cuda-nvtx-12.1.105-0
  cuda-opencl        nvidia/win-64::cuda-opencl-12.4.127-0
  cuda-opencl-dev    nvidia/win-64::cuda-opencl-dev-12.4.127-0
  cuda-profiler-api  nvidia/win-64::cuda-profiler-api-12.4.127-0
  cuda-runtime       nvidia/win-64::cuda-runtime-12.1.0-0
  filelock           pkgs/main/win-64::filelock-3.13.1-py38haa95532_0
  freetype           pkgs/main/win-64::freetype-2.12.1-ha860e81_0
  gmpy2              pkgs/main/win-64::gmpy2-2.1.2-py38h7f96b67_0
  idna               pkgs/main/win-64::idna-3.7-py38haa95532_0
  intel-openmp       pkgs/main/win-64::intel-openmp-2021.4.0-haa95532_3556
  jinja2             pkgs/main/win-64::jinja2-3.1.3-py38haa95532_0
  jpeg               pkgs/main/win-64::jpeg-9e-h2bbff1b_1
  lcms2              pkgs/main/win-64::lcms2-2.12-h83e58a3_0
  lerc               pkgs/main/win-64::lerc-3.0-hd77b12b_0
  libcublas          nvidia/win-64::libcublas-12.1.0.26-0
  libcublas-dev      nvidia/win-64::libcublas-dev-12.1.0.26-0
  libcufft           nvidia/win-64::libcufft-11.0.2.4-0
  libcufft-dev       nvidia/win-64::libcufft-dev-11.0.2.4-0
  libcurand          nvidia/win-64::libcurand-10.3.5.147-0
  libcurand-dev      nvidia/win-64::libcurand-dev-10.3.5.147-0
  libcusolver        nvidia/win-64::libcusolver-11.4.4.55-0
  libcusolver-dev    nvidia/win-64::libcusolver-dev-11.4.4.55-0
  libcusparse        nvidia/win-64::libcusparse-12.0.2.55-0
  libcusparse-dev    nvidia/win-64::libcusparse-dev-12.0.2.55-0
  libdeflate         pkgs/main/win-64::libdeflate-1.17-h2bbff1b_1
  libjpeg-turbo      pkgs/main/win-64::libjpeg-turbo-2.0.0-h196d8e1_0
  libnpp             nvidia/win-64::libnpp-12.0.2.50-0
  libnpp-dev         nvidia/win-64::libnpp-dev-12.0.2.50-0
  libnvjitlink       nvidia/win-64::libnvjitlink-12.1.105-0
  libnvjitlink-dev   nvidia/win-64::libnvjitlink-dev-12.1.105-0
  libnvjpeg          nvidia/win-64::libnvjpeg-12.1.1.14-0
  libnvjpeg-dev      nvidia/win-64::libnvjpeg-dev-12.1.1.14-0
  libpng             pkgs/main/win-64::libpng-1.6.39-h8cc25b3_0
  libtiff            pkgs/main/win-64::libtiff-4.5.1-hd77b12b_0
  libuv              pkgs/main/win-64::libuv-1.44.2-h2bbff1b_0
  libwebp-base       pkgs/main/win-64::libwebp-base-1.3.2-h2bbff1b_0
  lz4-c              pkgs/main/win-64::lz4-c-1.9.4-h2bbff1b_1
  markupsafe         pkgs/main/win-64::markupsafe-2.1.3-py38h2bbff1b_0
  mkl                pkgs/main/win-64::mkl-2021.4.0-haa95532_640
  mkl-service        pkgs/main/win-64::mkl-service-2.4.0-py38h2bbff1b_0
  mkl_fft            pkgs/main/win-64::mkl_fft-1.3.1-py38h277e83a_0
  mkl_random         pkgs/main/win-64::mkl_random-1.2.2-py38hf11a4ad_0
  mpc                pkgs/main/win-64::mpc-1.1.0-h7edee0f_1
  mpfr               pkgs/main/win-64::mpfr-4.0.2-h62dcd97_1
  mpir               pkgs/main/win-64::mpir-3.0.0-hec2e145_1
  mpmath             pkgs/main/win-64::mpmath-1.3.0-py38haa95532_0
  networkx           pkgs/main/win-64::networkx-3.1-py38haa95532_0
  numpy              pkgs/main/win-64::numpy-1.24.3-py38hf95b240_0
  numpy-base         pkgs/main/win-64::numpy-base-1.24.3-py38h005ec55_0
  openjpeg           pkgs/main/win-64::openjpeg-2.4.0-h4fc8c34_0
  pillow             pkgs/main/win-64::pillow-10.3.0-py38h2bbff1b_0
  pysocks            pkgs/main/win-64::pysocks-1.7.1-py38haa95532_0
  pytorch            pytorch/win-64::pytorch-2.3.0-py3.8_cuda12.1_cudnn8_0
  pytorch-cuda       pytorch/win-64::pytorch-cuda-12.1-hde6ce7c_5
  pytorch-mutex      pytorch/noarch::pytorch-mutex-1.0-cuda
  pyyaml             pkgs/main/win-64::pyyaml-6.0.1-py38h2bbff1b_0
  requests           pkgs/main/win-64::requests-2.31.0-py38haa95532_1
  six                pkgs/main/noarch::six-1.16.0-pyhd3eb1b0_1
  sympy              pkgs/main/win-64::sympy-1.12-py38haa95532_0
  torchaudio         pytorch/win-64::torchaudio-2.3.0-py38_cu121
  torchvision        pytorch/win-64::torchvision-0.18.0-py38_cu121
  typing_extensions  pkgs/main/win-64::typing_extensions-4.11.0-py38haa95532_0
  urllib3            pkgs/main/win-64::urllib3-2.1.0-py38haa95532_1
  win_inet_pton      pkgs/main/win-64::win_inet_pton-1.1.0-py38haa95532_0
  xz                 pkgs/main/win-64::xz-5.4.6-h8cc25b3_1
  yaml               pkgs/main/win-64::yaml-0.2.5-he774522_0
  zlib               pkgs/main/win-64::zlib-1.2.13-h8cc25b3_1
  zstd               pkgs/main/win-64::zstd-1.5.5-hd43e919_2


Proceed ([y]/n)? n


CondaSystemExit: Exiting.

(ml) PS Q:\projects\Backdoor-Attack-Against-Split-Neural-Network-Based-Vertical-Federated-Learning> python clean_train.py --clean-epoch 80 --dup 0 --multies 4 --unit 0.25
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to ./raw_data/cifar-10-python.tar.gz
1.3%
Traceback (most recent call last):
  File "clean_train.py", line 85, in <module>
    trainset = torchvision.datasets.CIFAR10(root='./raw_data/', train=True, download=True,
  File "C:\Users\xuan\anaconda3\envs\ml\lib\site-packages\torchvision\datasets\cifar.py", line 66, in __init__
    self.download()
  File "C:\Users\xuan\anaconda3\envs\ml\lib\site-packages\torchvision\datasets\cifar.py", line 140, in download
    download_and_extract_archive(self.url, self.root, filename=self.filename, md5=self.tgz_md5)
  File "C:\Users\xuan\anaconda3\envs\ml\lib\site-packages\torchvision\datasets\utils.py", line 395, in download_and_extract_archive
    download_url(url, download_root, filename, md5)
  File "C:\Users\xuan\anaconda3\envs\ml\lib\site-packages\torchvision\datasets\utils.py", line 132, in download_url
    _urlretrieve(url, fpath)
  File "C:\Users\xuan\anaconda3\envs\ml\lib\site-packages\torchvision\datasets\utils.py", line 30, in _urlretrieve
    while chunk := response.read(chunk_size):
  File "C:\Users\xuan\anaconda3\envs\ml\lib\http\client.py", line 459, in read
    n = self.readinto(b)
  File "C:\Users\xuan\anaconda3\envs\ml\lib\http\client.py", line 503, in readinto
    n = self.fp.readinto(b)
  File "C:\Users\xuan\anaconda3\envs\ml\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "C:\Users\xuan\anaconda3\envs\ml\lib\ssl.py", line 1274, in recv_into
    return self.read(nbytes, buffer)
  File "C:\Users\xuan\anaconda3\envs\ml\lib\ssl.py", line 1132, in read
    return self._sslobj.read(len, buffer)
KeyboardInterrupt
(ml) PS Q:\projects\Backdoor-Attack-Against-Split-Neural-Network-Based-Vertical-Federated-Learning> python clean_train.py --clean-epoch 80 --dup 0 --multies 4 --unit 0.25
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to ./raw_data/cifar-10-python.tar.gz
100.0%
Extracting ./raw_data/cifar-10-python.tar.gz to ./raw_data/
Files already downloaded and verified
Epoch 0, loss = 1.9170, acc = 0.2850
Epoch 1, loss = 1.6124, acc = 0.4071
Epoch 2, loss = 1.4924, acc = 0.4554
Epoch 3, loss = 1.3992, acc = 0.4909
Epoch 4, loss = 1.3065, acc = 0.5283
Epoch 5, loss = 1.2529, acc = 0.5490
Epoch 6, loss = 1.1956, acc = 0.5681
Epoch 7, loss = 1.1486, acc = 0.5881
Epoch 8, loss = 1.1110, acc = 0.6042
Epoch 9, loss = 1.0708, acc = 0.6173
Epoch 10, loss = 1.0370, acc = 0.6305
Epoch 11, loss = 1.0157, acc = 0.6397
Epoch 12, loss = 0.9745, acc = 0.6552
Epoch 13, loss = 0.9424, acc = 0.6665
Epoch 14, loss = 0.9283, acc = 0.6716
Epoch 15, loss = 0.9018, acc = 0.6813
Epoch 16, loss = 0.8861, acc = 0.6879
Epoch 17, loss = 0.8715, acc = 0.6930
Epoch 18, loss = 0.8501, acc = 0.7005
Epoch 19, loss = 0.8268, acc = 0.7096
Epoch 20, loss = 0.8114, acc = 0.7151
Epoch 21, loss = 0.8049, acc = 0.7183
Epoch 22, loss = 0.7947, acc = 0.7197
Epoch 23, loss = 0.7814, acc = 0.7292
Epoch 24, loss = 0.7594, acc = 0.7354
Epoch 25, loss = 0.7618, acc = 0.7342
Epoch 26, loss = 0.7423, acc = 0.7387
Epoch 27, loss = 0.7344, acc = 0.7410
Epoch 28, loss = 0.7226, acc = 0.7471
Epoch 29, loss = 0.7139, acc = 0.7491
Epoch 30, loss = 0.7041, acc = 0.7529
Epoch 31, loss = 0.6964, acc = 0.7571
Epoch 32, loss = 0.6875, acc = 0.7598
Epoch 33, loss = 0.6869, acc = 0.7615
Epoch 34, loss = 0.6802, acc = 0.7631
Epoch 35, loss = 0.6708, acc = 0.7675
Epoch 36, loss = 0.6621, acc = 0.7712
Epoch 37, loss = 0.6547, acc = 0.7732
Epoch 38, loss = 0.6567, acc = 0.7707
Epoch 39, loss = 0.6396, acc = 0.7803
Epoch 40, loss = 0.6402, acc = 0.7776
Epoch 41, loss = 0.6372, acc = 0.7786
Epoch 42, loss = 0.6284, acc = 0.7830
Epoch 43, loss = 0.6253, acc = 0.7831
Epoch 44, loss = 0.6205, acc = 0.7839
Epoch 45, loss = 0.6071, acc = 0.7898
Epoch 46, loss = 0.6074, acc = 0.7907
Epoch 47, loss = 0.6046, acc = 0.7907
Epoch 48, loss = 0.6000, acc = 0.7924
Epoch 49, loss = 0.6029, acc = 0.7903
Epoch 50, loss = 0.5958, acc = 0.7922
Epoch 51, loss = 0.5864, acc = 0.7960
Epoch 52, loss = 0.5856, acc = 0.7958
Epoch 53, loss = 0.5783, acc = 0.7988
Epoch 54, loss = 0.5750, acc = 0.8000
Epoch 55, loss = 0.5729, acc = 0.8021
Epoch 56, loss = 0.5698, acc = 0.8019
Epoch 57, loss = 0.5701, acc = 0.8028
Epoch 58, loss = 0.5627, acc = 0.8024
Epoch 59, loss = 0.5604, acc = 0.8045
Epoch 60, loss = 0.5612, acc = 0.8046
Epoch 61, loss = 0.5538, acc = 0.8060
Epoch 62, loss = 0.5542, acc = 0.8060
Epoch 63, loss = 0.5468, acc = 0.8086
Epoch 64, loss = 0.5482, acc = 0.8105
Epoch 65, loss = 0.5386, acc = 0.8109
Epoch 66, loss = 0.5397, acc = 0.8117
Epoch 67, loss = 0.5359, acc = 0.8144
Epoch 68, loss = 0.5367, acc = 0.8124
Epoch 69, loss = 0.5337, acc = 0.8142
Epoch 70, loss = 0.5270, acc = 0.8168
Epoch 71, loss = 0.5267, acc = 0.8171
Epoch 72, loss = 0.5267, acc = 0.8177
Epoch 73, loss = 0.5250, acc = 0.8164
Epoch 74, loss = 0.5176, acc = 0.8213
Epoch 75, loss = 0.5117, acc = 0.8199
Epoch 76, loss = 0.5155, acc = 0.8199
Epoch 77, loss = 0.5162, acc = 0.8198
Epoch 78, loss = 0.5042, acc = 0.8226
Epoch 79, loss = 0.5122, acc = 0.8222
Epoch 0, loss = 0.5162, acc = 0.8202
Epoch 1, loss = 0.5128, acc = 0.8237
Epoch 2, loss = 0.5062, acc = 0.8219
Epoch 3, loss = 0.4975, acc = 0.8282
Epoch 4, loss = 0.4962, acc = 0.8275
Epoch 5, loss = 0.4979, acc = 0.8279
Epoch 6, loss = 0.4903, acc = 0.8278
Epoch 7, loss = 0.4996, acc = 0.8251
Epoch 8, loss = 0.4887, acc = 0.8296
Epoch 9, loss = 0.4902, acc = 0.8315
Epoch 10, loss = 0.4829, acc = 0.8310
Epoch 11, loss = 0.4873, acc = 0.8317
Epoch 12, loss = 0.4793, acc = 0.8316
Epoch 13, loss = 0.4823, acc = 0.8318
Epoch 14, loss = 0.4836, acc = 0.8317
Epoch 15, loss = 0.4837, acc = 0.8320
Epoch 16, loss = 0.4744, acc = 0.8341
Epoch 17, loss = 0.4731, acc = 0.8349
Epoch 18, loss = 0.4720, acc = 0.8327
Epoch 19, loss = 0.4769, acc = 0.8339
clean acc: 0.8353
Training a model costs 1328.1520s.